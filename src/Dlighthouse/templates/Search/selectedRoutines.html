<script type="text/javascript">
	var selectedRoutine_session = [];
	var uncheckedRoutines = [];
</script>

<div id="selectedRoutines">
	<form>
		<!--Dropped-items area-->
		<div style="padding: 10px;">
			<div id="selectedListNode" class="container2" style="border: 1px solid #444; background: #eee; padding-bottom: 15px; padding-left:30px; background-image: url(/media/Images/dropRoutine.png); background-repeat: no-repeat; background-position:top; padding-top: 35px;">

				<div id="sel_routineListNode" class="container2" style="background: #eee; padding: 0px;">
			{% if selectedRoutines %}
			{% for item in selectedRoutines %}
		
				{% if item.checkState == "checked" %}
				<!--generate the selectedRoutine_session array for code generation for the case of no dnd action-->
				<script type="text/javascript">
					selectedRoutine_session.push('{{ item.thePrecision }}'+'{{ item.routineName }}');				
				</script>

				{% endif %}

				{% if item.checkState == "unchecked" %}
				<!--generate the selectedRoutine_session array for code generation for the case of no dnd action-->
				<script type="text/javascript">
					uncheckedRoutines.push('{{ item.thePrecision }}'+'{{ item.routineName }}');				
				</script>

				{% endif %}

				<div class="sel_dojoDndItem" id="sel_{{ item.thePrecision|upper }}{{ item.routineName|upper }}" style="list-style-type: none;">
					<div class="routineName">
						<table id="ts_{{ item.thePrecision|upper }}{{ item.routineName|upper }}">
							<tr id="trs_{{ item.thePrecision|upper }}{{ item.routineName|upper }}">
								<td style="font-weight: bold; width: 70px;">
									<input type="checkbox" name="{{ item.thePrecision|upper }}{{ item.routineName|upper }}" {% if item.checkState == "checked" %} checked="checked" {% endif %} value="{{ item.thePrecision }}_{{ item.routineName }}_{{ item.matrixType }}_{{ item.storageType }}_{{ item.id }}_{{ item.url }}" id="cbs_{{ item.thePrecision|upper }}{{ item.routineName|upper }}" onclick="checkChanged('{{ item.thePrecision|upper }}{{ item.routineName|upper }}', selectedRoutineNames, selectedRoutine_session, uncheckedRoutines, 'selectedRoutine');"/> {{ item.thePrecision|upper }}{{ item.routineName|upper }}
								</td>
								<td>						
									<img src="{{ MEDIA_URL }}Images/question.png" width="16" height="16" onclick="dijit.byId('sel_{{ item.id }}').show()"/>	
								</td>														
							</tr>
						</table>											
					</div>
					<div class="dijitHidden">
						<div id="sel_{{ item.id }}" dojoType="dijit.Dialog" title="Routine Info - {{ item.thePrecision|upper }}{{ item.routineName|upper }}">
							<div align="center">
								<table id="table_main" width="80%" border = "1">
									<tr>
									<th>Precision</th>
									<th>Routine Name</th>
									<th>Matrix Type</th>
									<th>Storage</th>
									</tr>
									<tr>
									<td>{{ item.thePrecision|upper }}</td>
									<td>{{ item.routineName|upper }}</td> 
									<td>{{ item.matrixType }}</td> 
									<td>{{ item.storageType }}</td>      
									</tr>
								</table><br/>
								<iframe src="{{ item.url }}" width="640px" height="400px"></iframe><br/></br> 
								<button onClick="dijit.byId('sel_{{ item.id }}').hide()">Close</button>
							</div>
						</div>
					</div>					
				</div>
			{% endfor %}
			{% endif %}
			</div>

			</div>
		</div>
		
		<!--load request.session["selectedRoutines]-->
		
		
		

		<div id="button-div">
		    <table style="width:100%; margin: 0px auto;">
				<tr style="width:100%;">
					<td style="text-align:left;">								
						<button type="button" onclick="clearAllRoutines(); selectedRoutineNames.length = 0; selectedRoutine_session.length = 0; uncheckedRoutines.length = 0;">
							Clear All
						</button>
					</td>
					<td style="text-align:left;">								
						<button type="button" onclick="clearSelectedRoutines(uncheckedRoutines, selectedRoutineNames); uncheckedRoutines.length = 0;">
							Clear Unchecked
						</button>
					</td>
					<td style="text-align:right;">
						<button type="button" onclick="Dajaxice.Driver.createTemplate(Dajax.process, {'selectedRoutine_ajax': selectedRoutineNames, 'selectedRoutine_session': selectedRoutine_session});">
							Generate Template
						</button>
					</td>				
				</tr>
		    </table>
		</div>

	</form>
</div>

