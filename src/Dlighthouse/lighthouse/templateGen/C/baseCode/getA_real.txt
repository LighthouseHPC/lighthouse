begin gesv sgesv geequ geequb
  /*--- to call a Fortran routine from C, matrices must be transformed into their Fortran vector formats ---*/
  /*--- read A and transform it to AT ---*/
  for(i=0; i<lda; i++){
    for(j=0; j<n; j++){
      fscanf(fptA, "%placeholder",&AT[i+lda*j]);
    }
  }
  
end gesv sgesv geequ geequb
 

begin gtsv
  /*--- get DU, D, and DL ---*/
  for (i=0; i<3; i++){
    if (i==0){
      for(j=0; j<n-1; j++){
        fscanf(fptA, "%placeholder",&DU[j]);
      }
    }
    else if (i==1){
      for(j=0; j<n; j++){
        fscanf(fptA, "%placeholder",&D[j]);
      }     
    }
    else if (i==2){
      for(j=0; j<n-1; j++){
        fscanf(fptA, "%placeholder",&DL[j]);
      }      
    }
  }
  
end gtsv


begin ptsv
  /*--- get D and E ---*/
  for (i=0; i<2; i++){
    if (i==0){
      for(j=0; j<n; j++){
        fscanf(fptA, "%placeholder",&D[j]);
      }
    }
    else if (i ==1){
      for(j=0; j<n-1; j++){
        fscanf(fptA, "%placeholder",&E[j]);
      }     
    }
  }

end ptsv


begin gbsv
  /*--- to call a Fortran routine from C, matrices must be transformed into their Fortran vector formats ---*/
  /*--- read AB ---*/
  for(i=0; i<n; i++){
    for(j=max(i-kl,0); j<=min(i+ku,n-1); j++){
      fscanf(fptA, "%placeholder",&AB[kl+ku+i-j][j]);
    }
  }    

  /*--- transform AB to ABT ---*/
  for (i=0; i<ldab; i++){
    for (j=0; j<n; j++){
      ABT[i+ldab*j]=AB[i][j];
    }
  }
  
end gbsv


begin gbequ gbequb
  /*--- to call a Fortran routine from C, matrices must be transformed into their Fortran vector formats ---*/  
  /*--- read AB ---*/
  for(i=0; i<m; i++){
    for(j=max(i-kl,0); j<=min(i+ku,n-1); j++){
      fscanf(fptA, "%placeholder",&AB[ku+i-j][j]);                
    }
  }    

  /*--- transform AB to ABT ---*/
  for (i=0; i<ldab; i++){
    for (j=0; j<n; j++){
      ABT[i+ldab*j]=AB[i][j];
    }
  }
  
end gbequ gbequb


begin pbsv pbequ
  /*--- to call a Fortran routine from C, matrices must be transformed into their Fortran vector formats ---*/
  /*--- read AB ---*/
  if (UPLO =='U' || UPLO =='u'){
    for(i=0; i<n; i++){
      for(j=i; j<min(i+1+kd,n); j++){
        fscanf(fptA, "%placeholder",&AB[kd+i-j][j]);
      }
    }   
  }
  else if (UPLO =='L' || UPLO =='l' ){
    for(i=0; i<n; i++){
      for(j=max(0,i-kd); j<=i; j++){
        fscanf(fptA, "%placeholder",&AB[i-j][j]);
      }
    }
  }
  else{
    printf("Invalid UPLO value!\n");
    exit(EXIT_FAILURE);
    }


    
  /*--- transform AB into its Fortran vector format, ABT ---*/
  for (i=0; i<ldab; i++){
    for (j=0; j<n; j++){
      ABT[i+ldab*j]=AB[i][j];
    }
  }

end pbsv pbequ


begin sysv posv sposv poequ poequb syequb heequb
  /*--- to call a Fortran routine from C, matrices must be transformed into their Fortran vector formats ---*/
  /*--- read A and transform it to AT ---*/
  if (UPLO == 'U' || UPLO == 'u'){
    for(i=0; i<lda; i++){
      for(j=i; j<n; j++){
        fscanf(fptA, "%placeholder",&AT[i+lda*j]);
      }
    }    
  }
  else if (UPLO == 'L' || UPLO == 'l' ){
    for(i=0; i<lda; i++){
      for(j=0; j<=i; j++){
        fscanf(fptA, "%placeholder",&AT[i+lda*j]);
      }
    }
  }
  else{
    printf("Invalid UPLO value!\n");
    exit(EXIT_FAILURE);
    }

end sysv posv sposv poequ poequb syequb heequb


begin ppsv spsv ppequ
  /*--- get AP ---*/
  if (UPLO == 'U' || UPLO == 'u'){
    for(i=0; i<n; i++){
      for(j=i; j<n; j++){
        fscanf(fptA, "%placeholder",&AP[(i+1)+j*(j+1)/2-1]);
      }
    }    
  }
  else if (UPLO == 'L' || UPLO == 'l' ){
    for(i=0; i<n; i++){
      for(j=0; j<=i; j++){
        fscanf(fptA, "%placeholder",&AP[i+j*(2*SIZE-j-1)/2]);
      }
    }
  }
  else{
    printf("Invalid UPLO value!\n");
    exit(EXIT_FAILURE);
    }
    
end ppsv spsv ppequ

